<include file="public/header" title="设置" body="g4"/>
<link rel="stylesheet" href="__STATIC__/css/cf_user_info.css">
<div class="classreturn loginsignup ">
	<div class="content">
		<div class="ds-in-bl return">
			<a href="{:U('Mobile/User/index')}"><img src="__STATIC__/images/return.png" alt="返回"></a>
		</div>
		<div class="ds-in-bl search center">
			<span>设置</span>
		</div>
	</div>
</div>

<div class="floor my p setting" style="margin-top: 1.8rem">
	<div class="content">
		<div class="floor list7">
			<!--//请设置您的头像-->
			<div class="myorder he p">
				<div class="content30">
					<div class="order">
						<div class="fl">
							<span>头像</span>
							<span class="bridh"></span>
						</div>
						<div class="fr">
							<div class="hendicon">
								<span></span>
								<form id="head_pic" method="post" enctype="multipart/form-data">
									<label class="file" style="cursor:pointer;">
										<div class="around" id="fileList">
											<img src="{$user[head_pic]|default='http://cdn.cfo2o.com/data/avatar/user_head_default.png'}?x-oss-process=style/s150x150"/>
											<input  type="file" accept="image/*" name="head_pic"  onchange="handleFiles(this)" style="display:none">
										</div>
									</label>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--请设置您的用户名-->
			<div class="myorder p">
				<div class="content30">
					<a href="{:U('Mobile/User/userinfo',array('action'=>'nickname'))}">
						<div class="order">
							<div class="fl">
								<span>昵称</span>
							</div>
							<div class="fr">
								<span style="color: #1E1B1B">{$user.nickname}</span>
								<i class="Mright"></i>
							</div>
						</div>
					</a>
				</div>
			</div>
			<!--手机号-->
			<div class="myorder p bo" id="">
				<div class="content30">
					<a href="{:U('Mobile/User/userinfo',array('action'=>'changeMobile'))}">
						<div class="order">
							<div class="fl">
								<span>手机号</span>
							</div>
							<div class="fr">
								<span style="color: #1E1B1B">{$mobile}</span>
								<i class="Mright"></i>
							</div>
						</div>
					</a>
				</div>
			</div>
			<!--性别-->
			<div class="myorder p">
				<div class="content30">
					<a href="{:U('Mobile/User/userinfo',array('action'=>'sex'))}">
						<div class="order">
							<div class="fl">
								<span>性别</span>
							</div>
							<div class="fr">
								<span style="color: #1E1B1B">{$sex[$user.sex]}</span>
								<i class="Mright"></i>
							</div>
						</div>
					</a>
				</div>
			</div>

			<!--年龄-->
			<div class="myorder p bo" id="cf_bottom">
				<div class="content30">
					<a href="{:U('Mobile/User/userinfo',array('action'=>'age'))}">
						<div class="order">
							<div class="fl">
								<span>年龄</span>
							</div>
							<div class="fr">
								<span style="color: #1E1B1B">{$user.age}</span>
								<i class="Mright"></i>
							</div>
						</div>
					</a>
				</div>
			</div>
			<!--肤质-->
			<div class="myorder p bo" >
				<div class="content30">
					<a href="{:U('Mobile/User/userinfo',array('action'=>'skinQuality'))}">
						<div class="order">
							<div class="fl">
								<span>肤质</span>
							</div>
							<if condition="empty($user_skin_datas)">
									<div class="fr">
										<span>未测试</span>
										<i class="Mright"></i>
									</div>
								<else/>
								<div class="fr" >
									<span  style="display: inline-block;color: #1E1B1B;height: 1rem;line-height: .8rem;padding: .1rem .2rem;
									border: 1px solid #5B5858;border-radius: .1rem;font-size: .5rem;margin-left: .2rem;margin-top: .5rem;">{$user_skin_datas[0]['name']}</span>
									<span  style="display: inline-block;color: #1E1B1B;height: 1rem;line-height: .8rem;padding: .1rem .2rem;
									border: 1px solid #5B5858;border-radius: .1rem;font-size: .5rem;margin-left: .2rem;margin-top: .5rem;">{$user_skin_datas[1]['name']}</span>
									<i class="Mright"></i>
								</div>
							</if>

						</div>
					</a>
				</div>
			</div>
			<!--s认证-->
			<div class="myorder p" style="margin-top: .5rem">
				<div class="content30">
						<div class="order">
							<div class="fl">
								<span>实名认证</span>
							</div>
							<if condition="$isAuth !== 0">
								<a href="{:U('Mobile/Distribution/authentication')}">
									<div class="fr">
										<span style="color: #1E1B1B">{$isAuth}</span>
										<i class="Mright"></i>
									</div>
								</a>
							<else/>
								<a href="{:U('Mobile/Distribution/authentication')}">
									<div class="fr">
										<span>未认证</span>
										<i class="Mright"></i>
									</div>
								</a>
							</if>
						</div>
				</div>
			</div>
			<!--支付密码-->
			<div class="myorder p">
				<div class="content30">
					<a href="{:U('Mobile/User/paypwd')}">
						<div class="order">
							<div class="fl">
								<span>支付密码</span>
							</div>
							<div class="fr">
								<if condition="$is_set_paypwd">
									<span style="color: #1E1B1B">******</span>
									<else>
										<span>未设置</span>
								</if>
								<i class="Mright"></i>
							</div>
						</div>
					</a>
				</div>
			</div>
	</div>
	<div class="close">
		<!--<if condition="!$is_wx">-->
		<a href="{:U('User/logout')}"  id="logout" onclick="removeLoc()">安全退出</a>
		<!--</if>-->
		<a id="asubmit" style="display:none;" href="javascript:;" onclick="javascript:$('#head_pic').submit();">保存头像</a>
	</div>
</div>
</div>
	<script>
	//显示上传照片
	window.URL = window.URL || window.webkitURL;
	function handleFiles(obj) {
		fileList = document.getElementById("fileList");
		var files = obj.files;
		img = new Image();
		if(window.URL){
			img.src = window.URL.createObjectURL(files[0]); //创建一个object URL，并不是你的本地路径
			img.width = 60;
			img.height = 60;
			img.onload = function(e) {
				window.URL.revokeObjectURL(this.src); //图片加载后，释放object URL
			}
			if(fileList.firstElementChild){
				fileList.removeChild(fileList.firstElementChild);
			}
			$('#fileList').find('img').remove();
			fileList.appendChild(img);
		}else if(window.FileReader){
			//opera不支持createObjectURL/revokeObjectURL方法。我们用FileReader对象来处理
			var reader = new FileReader();
			reader.readAsDataURL(files[0]);
			reader.onload = function(e){
				img.src = this.result;
				img.width = 60;
				img.height = 60;
				$('#fileList').find('img').remove();
				fileList.appendChild(img);
			}
		}else
		{
			//ie
			obj.select();
			obj.blur();
			var nfile = document.selection.createRange().text;
			document.selection.empty();
			img.src = nfile;
			img.width = 60;
			img.height = 60;
			img.onload=function(){

			}
			$('#fileListfileList').find('img').remove();
			fileList.appendChild(img);
		}
		$('#asubmit').show();
		// $('#logout').hide();
		$('#head_pic').submit();
	}

	$(function(){
		var ua = window.navigator.userAgent.toLowerCase();
		if(ua.match(/MicroMessenger/i) == 'micromessenger'){
			// $('#logout').hide();
		}

		// 获取 状态 判断 显示是否跳过
		//获取cookie
		function getCookie(cname){
			var name = cname + "=";
			var ca = document.cookie.split(';');
			for(var i=0; i<ca.length; i++) {
				var c = ca[i].trim();
				if (c.indexOf(name)==0) { return c.substring(name.length,c.length); }
			}
			return "";
		}
		var loc = localStorage.getItem('isFirst');
		var cf_frist  = getCookie('is_first_login');

		// 设置 电话号码 样式
		var cf_mobile = getCookie('mobile').replace(/(\d{3})\d{4}(\d{4})/, '$1****$2');
		$('#cf_mobile').html(cf_mobile);

	});
	function removeLoc() {
		localStorage.removeItem('isFirst');
	}
	//获取cookie
	function getCookie(cname){
		var name = cname + "=";
		var ca = document.cookie.split(';');
		for(var i=0; i<ca.length; i++) {
			var c = ca[i].trim();
			if (c.indexOf(name)==0) { return c.substring(name.length,c.length); }
		}
		return "";
	}
	var cf_history_url = unescape(getCookie('refer_url'));
	function cf_history(){
		if(cf_history_url){
			location.href= cf_history_url;
		} else {
			location.href="{:U('Mobile/Index/index')}";
		}
	}

	</script>
	</body>
</html>