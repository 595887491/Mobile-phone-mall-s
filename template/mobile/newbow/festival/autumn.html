<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>过中秋啦</title>
    <script src="__STATIC__/js/jquery-3.1.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="__STATIC__/js/rem.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" type="text/css" href="__STATIC__/css/iconfont.css"/>
    <script src="__PUBLIC__/js/global.js"></script>
    <script src="__STATIC__/js/layer.js"  type="text/javascript" ></script>
    <link rel="shortcut icon" type="image/x-icon" href="{$tpshop_config.shop_info_store_ico|default='/public/static/images/logo/storeico_default.png'}" media="screen"/>
    <link rel="stylesheet" href="__STATIC__/css/autumn.css">
</head>
<style>
    .voteTop{
        /*background: url("__STATIC__/images/autumnbg.png")repeat;*/
        /*background-size: 100%;*/
        /*height: 4rem;*/
        font-size: .24rem;
    }

</style>
<body>
<!--bg-->
<div class="voteTop">
    <img src="__STATIC__/images/autumnbg.png" alt="" style="width: 100%">
    <div class="votePos">
        <div class="voteHeader" >
            <div class="fl voteHeaderLeft backLeft" onclick="goBack()"><img src="__STATIC__/images/banck.png" alt=""></div>
            <div class="fl voteHeaderLeft backLeftTwo" onclick="goBack()"><img src="__STATIC__/images/banck1.png" alt=""></div>
            <div class="fr voteHeaderRight" onclick="jumpRule()"><span>活动规则</span></div>
        </div>
        <div class="bgCover"></div>
    </div>
</div>
<div class="autumn_bg">
    <img src="__STATIC__/images/autumn_1.png" alt="">
</div>
<div class="autumn_bg">
    <img src="__STATIC__/images/autumn_2.png" alt="">
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '16','goods_id' => '1846'])}">
        <img src="__STATIC__/images/autumn_3.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '15','goods_id' => '1658'])}">
        <img src="__STATIC__/images/autumn_4.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '17' , 'goods_id' => '1678'])}">
        <img src="__STATIC__/images/autumn_5.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '18' , 'goods_id' => '1000038'])}">
        <img src="__STATIC__/images/autumn_6.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '3' , 'goods_id' => '1818'])}">
        <img src="__STATIC__/images/autumn_7.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '19' , 'goods_id' => '1392'])}">
        <img src="__STATIC__/images/autumn_8.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '10' , 'goods_id' => '1920'])}">
        <img src="__STATIC__/images/autumn_9.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '14' , 'goods_id' => '1000229'])}">
        <img src="__STATIC__/images/autumn_10.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '8' , 'goods_id' => '1000116'])}">
        <img src="__STATIC__/images/autumn_11.png" alt="">
    </a>
</div>
<div class="autumn_bg">
    <a href="{:U('Mobile/Team/info',['team_id' => '12' , 'goods_id' => '1000186'])}">
        <img src="__STATIC__/images/autumn_12.png" alt="">
    </a>
</div>

<!--推荐喜欢-->
<div class="guessLike">
    <div class="guessLikeTop">
        <img src="__STATIC__/images/guessLike_two.png" alt="">
    </div>
    <div class="guessList clearFix">
        <foreach name="$goodsList" item="v">
            <a href="{:U('mobile/Goods/goodsInfo',['id'=>$v.goods_id])}">
                <div class="guessItem">
                    <!--src="{$v[original_img]}?x-oss-process=style/s01"-->
                    <img class="lazy" data-original="{$v[original_img]}?x-oss-process=style/s340x340" alt="">
                    <p class="guessTitle">{$v['goods_remark']}</p>
                    <p class="guessCom">{$v['goods_name']}</p>
                    <div class="guessDiv"><span style="color: #FF407E">¥</span><span style="font-size: .34rem;color: #FF407E">{$v['shop_price']}</span><span style="color: #BFC1CD;margin-left: .2rem;text-decoration: line-through">¥{$v['market_price']}</span></div>
                </div>
            </a>
        </foreach>
    </div>
</div>

<div class="noMore">
    <span>没有更多了</span>
</div>
<!--分享开始-->
<script>
    // http://cdn.cfo2o.com/public/upload/other/logo_share.png
    var ShareImgUrl ="https://{$_SERVER[HTTP_HOST]}__STATIC__/images/fxautumn.png"; //分享图标
    var ShareTitle = "中秋拼团献礼，9.9包邮到底！"; //分享标题
    var ShareDesc = "你负责团圆回家，我负责送货到家"; //分享描述s
    var ShareLink = "{:U('Mobile/festival/autumn','',true,true)}"; //分享描述
</script>
<include file="public/wx_share"/>
<!--分享结束-->
<script type="text/javascript" src="__STATIC__/js/sourch_submit.js"></script>
<script type="text/javascript" src="__STATIC__/js/jquery.lazyload.js"></script>
<script>
    //滚动事件 / 滑动头部过渡的效果
    $(function(){
        var $body = $('body');
        var setCoverOpacity = function() {
            $('.bgCover').css({
                opacity: ((($(document).scrollTop() / $('.votePos').height()) > 1) ? 1 : ($(document).scrollTop() / $('.votePos').height()))
            });
        };
        //初始化设置背景透明度
        // setCoverOpacity();
        //监听滚动条事件，改变透明度
        $(window).scroll(function() {
            setCoverOpacity();
        });
    });
    // 出现滚动条时出返回顶部按钮  开始
    $(function() {
        if ($(window).scrollTop() < 50) {
            $('.voteHeaderRight span ').css('color','#fff');
            $('.backLeft ').css('display','none');
            $('.backLeftTwo ').css('display','block');
        }

        $(window).scroll(function() {
            if ($(window).scrollTop() >= 50) {
                $('.voteHeaderRight span ').css('color','#300b46');
                $('.backLeftTwo ').css('display','none');
                $('.backLeft ').css('display','block');
            } else {
                $('.voteHeaderRight span ').css('color','#fff');
                $('.backLeft ').css('display','none');
                $('.backLeftTwo ').css('display','block');
            }
        });
    });

    /**
     * ajax加载更多数据
     */
    var ajax_pending = false;//进行中
    var has_more_data = true;//还有数据
    var  page = 0;
    var datahtml ='';
    function ajax_sourch_submit() {
        if (ajax_pending || has_more_data == false) return;
        ajax_pending = true;
        ++page;
        $.ajax({
            type : "GET",
            url:"/index.php?m=Mobile&c=festival&a=ajax_autumn&topicId=56&p="+page,
            success: function(data) {
                ajax_pending = false;
                if ($.trim(data) != '') {
                    $('.guessList').append(data);
                    datahtml += data;
                    sessionStorage.setItem("autumnData", datahtml);
                    //加载更多时 懒加载配置
                    $("img.lazy").lazyload({effect: "fadeIn"});
                    $("img.lazy").lazyload({ threshold :180});
                    // setTimeout(function () {
                    //     sessionStorage.removeItem("moreData");
                    // },5000);
                } else {
                    has_more_data = false;
                    $('.noMore').show()
                }
            }
        });
    }
    // 判断是否有缓存 数据 猜你喜欢  返回到浏览位置
    $(function () {
        var a = sessionStorage.getItem("autumnData");
        if(a != '') {
            $('.guessList').html(a);
        }
    });

    // 懒加载  相关配置
    $(function() {
        $("img.lazy").lazyload({effect: "fadeIn"});
    });
    $("img.lazy").lazyload({ threshold :200});
    $("img.lazy").lazyload({
        placeholder : "/template/mobile/newbow/static/images/aa.png", //用图片提前占位
        // placeholder,值为某一图片路径.此图片用来占据将要加载的图片的位置,待图片加载时,占位图则会隐藏
        effect: "fadeIn", // 载入使用何种效果
        // effect(特效),值有show(直接显示),fadeIn(淡入),slideDown(下拉)等,常用fadeIn
        threshold: 200, // 提前开始加载
        // threshold,值为数字,代表页面高度.如设置为200,表示滚动条在离目标位置还有200的高度时就开始加载图片,可以做到不让用户察觉
        event: 'click',  // 事件触发时才加载
        // event,值有click(点击),mouseover(鼠标划过),sporty(运动的),foobar(…).可以实现鼠标莫过或点击图片才开始加载,后两个值未测试…
        container: $(".guessItem"),  // 对某容器中的图片实现效果
        // container,值为某容器.lazyload默认在拉动浏览器滚动条时生效,这个参数可以让你在拉动某DIV的滚动条时依次加载其中的图片
        failurelimit : 10 // 图片排序混乱时
        // failurelimit,值为数字.lazyload默认在找到第一张不在可见区域里的图片时则不再继续加载,但当HTML容器混乱的时候可能出现可见区域内图片并没加载出来的情况,failurelimit意在加载N张可见区域外的图片,以避免出现这个问题.
    });
    
    function jumpRule() {
        window.location.href = "{:U('Mobile/festival/autumnRule')}";
    }
    // 分享后 判断是否有上一级页面
    function goBack(){
        var his = document.referrer;
        if(his) {
            history.back(-1)
        }else {
            window.location.href = "{:U('Mobile/Index/index')}";
        }
    }
</script>
</body>
</html>